<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>A402 Creator Studio · Apertum</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=DM+Mono:wght@300;400;500&family=Sora:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg: #050608;
      --bg-elevated: #0a0d12;
      --bg-panel: #0e1219;
      --bg-input: #111620;
      --border: #1a1f2e;
      --border-focus: #2d6adf;
      --text: #c8cdd8;
      --text-dim: #5a6275;
      --text-bright: #edf0f7;
      --text-muted: #3d4455;
      --accent: #2d6adf;
      --accent-light: #4a8af5;
      --accent-dim: #1d4a9e;
      --accent-glow: rgba(45, 106, 223, 0.15);
      --mint: #34d399;
      --mint-dim: rgba(52, 211, 153, 0.1);
      --amber: #f59e0b;
      --amber-dim: rgba(245, 158, 11, 0.1);
      --rose: #f43f5e;
      --rose-dim: rgba(244, 63, 94, 0.08);
      --violet: #8b5cf6;
      --violet-dim: rgba(139, 92, 246, 0.08);
      --radius-sm: 8px;
      --radius: 12px;
      --radius-lg: 16px;
      --radius-xl: 20px;
      --font-mono: 'DM Mono', monospace;
      --font-body: 'Sora', sans-serif;
      --shadow-glow: 0 0 60px rgba(45, 106, 223, 0.08);
      --transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    html { scroll-behavior: smooth; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: var(--font-body);
      min-height: 100vh;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    /* ─── Atmospheric background ─── */
    .atmosphere {
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      overflow: hidden;
    }
    .atmosphere::before {
      content: '';
      position: absolute;
      top: -40%; left: -20%;
      width: 800px; height: 800px;
      background: radial-gradient(circle, rgba(45, 106, 223, 0.06) 0%, transparent 70%);
      animation: drift 20s ease-in-out infinite;
    }
    .atmosphere::after {
      content: '';
      position: absolute;
      bottom: -30%; right: -15%;
      width: 600px; height: 600px;
      background: radial-gradient(circle, rgba(139, 92, 246, 0.04) 0%, transparent 70%);
      animation: drift 25s ease-in-out infinite reverse;
    }
    @keyframes drift {
      0%, 100% { transform: translate(0, 0); }
      50% { transform: translate(40px, -30px); }
    }
    .noise-overlay {
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      opacity: 0.025;
      background: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
    }

    /* ─── Layout shell ─── */
    .shell {
      position: relative; z-index: 1;
      display: grid;
      grid-template-columns: 280px 1fr;
      min-height: 100vh;
    }

    /* ─── Sidebar ─── */
    .sidebar {
      background: var(--bg-elevated);
      border-right: 1px solid var(--border);
      padding: 28px 20px;
      display: flex;
      flex-direction: column;
      position: sticky;
      top: 0;
      height: 100vh;
      overflow-y: auto;
    }
    .sidebar-brand {
      display: flex; align-items: center; gap: 12px;
      margin-bottom: 36px; padding-bottom: 24px;
      border-bottom: 1px solid var(--border);
    }
    .brand-mark {
      width: 38px; height: 38px;
      background: linear-gradient(135deg, var(--accent), var(--violet));
      border-radius: 10px;
      display: grid; place-items: center;
      font-family: var(--font-mono); font-weight: 500;
      font-size: 15px; color: #fff;
      flex-shrink: 0;
    }
    .brand-label { font-size: 14px; font-weight: 600; color: var(--text-bright); line-height: 1.3; }
    .brand-label small { display: block; font-size: 11px; font-weight: 400; color: var(--text-dim); font-family: var(--font-mono); margin-top: 2px; }

    .nav-section { margin-bottom: 28px; }
    .nav-section-title {
      font-family: var(--font-mono); font-size: 10px; font-weight: 500;
      text-transform: uppercase; letter-spacing: 1.5px;
      color: var(--text-muted); margin-bottom: 10px; padding-left: 12px;
    }
    .nav-item {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 12px; border-radius: var(--radius-sm);
      font-size: 13px; font-weight: 400; color: var(--text-dim);
      cursor: pointer; transition: all var(--transition);
      border: 1px solid transparent;
    }
    .nav-item:hover { color: var(--text); background: rgba(255,255,255,0.02); }
    .nav-item.active {
      color: var(--text-bright); background: var(--accent-glow);
      border-color: rgba(45, 106, 223, 0.15);
    }
    .nav-item svg { width: 18px; height: 18px; stroke: currentColor; fill: none; stroke-width: 1.8; stroke-linecap: round; stroke-linejoin: round; flex-shrink: 0; }
    .nav-badge {
      margin-left: auto; font-family: var(--font-mono); font-size: 10px;
      padding: 2px 7px; border-radius: 10px;
      background: var(--accent-dim); color: var(--accent-light);
    }

    .sidebar-footer {
      margin-top: auto; padding-top: 20px; border-top: 1px solid var(--border);
    }
    .chain-status {
      display: flex; align-items: center; gap: 8px;
      font-family: var(--font-mono); font-size: 11px; color: var(--text-dim);
      padding: 10px 12px; border-radius: var(--radius-sm);
      background: rgba(52, 211, 153, 0.04); border: 1px solid rgba(52, 211, 153, 0.08);
    }
    .chain-dot {
      width: 7px; height: 7px; border-radius: 50%;
      background: var(--mint); flex-shrink: 0;
      animation: blink 2.5s ease infinite;
    }
    @keyframes blink { 0%,100% { opacity: 1; } 50% { opacity: 0.3; } }

    /* ─── Main content ─── */
    .main { padding: 36px 44px 80px; overflow-y: auto; }

    .page-header { margin-bottom: 40px; }
    .page-header h1 {
      font-size: 28px; font-weight: 700; color: var(--text-bright);
      letter-spacing: -0.5px; margin-bottom: 8px;
    }
    .page-header p { font-size: 14px; color: var(--text-dim); max-width: 560px; }

    /* ─── Steps indicator ─── */
    .wizard-steps {
      display: flex; gap: 6px; margin-bottom: 36px;
    }
    .wiz-step {
      display: flex; align-items: center; gap: 8px;
      padding: 10px 16px; border-radius: var(--radius);
      border: 1px solid var(--border); background: var(--bg-elevated);
      font-size: 12px; color: var(--text-dim);
      transition: all var(--transition); cursor: pointer;
    }
    .wiz-step .num {
      width: 24px; height: 24px; border-radius: 50%;
      display: grid; place-items: center;
      font-family: var(--font-mono); font-size: 11px; font-weight: 500;
      background: var(--bg-input); border: 1px solid var(--border);
      color: var(--text-dim); transition: all var(--transition);
    }
    .wiz-step.active {
      border-color: var(--accent); background: var(--accent-glow);
      color: var(--text-bright);
    }
    .wiz-step.active .num {
      background: var(--accent); border-color: var(--accent);
      color: #fff;
    }
    .wiz-step.completed .num {
      background: var(--mint); border-color: var(--mint); color: #fff;
    }
    .wiz-step.completed { border-color: rgba(52,211,153,0.2); color: var(--text); }
    .wiz-step-divider { width: 20px; height: 1px; background: var(--border); align-self: center; }

    /* ─── Form sections ─── */
    .form-section {
      display: none;
      animation: sectionIn 0.35s ease;
    }
    .form-section.active { display: block; }
    @keyframes sectionIn {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .section-card {
      background: var(--bg-panel);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      padding: 32px;
      margin-bottom: 24px;
      transition: border-color var(--transition);
    }
    .section-card:hover { border-color: rgba(255,255,255,0.06); }
    .section-card h2 {
      font-size: 17px; font-weight: 600; color: var(--text-bright);
      margin-bottom: 6px; display: flex; align-items: center; gap: 10px;
    }
    .section-card h2 .icon-badge {
      width: 30px; height: 30px; border-radius: 8px;
      display: grid; place-items: center;
      background: var(--accent-glow); border: 1px solid rgba(45,106,223,0.12);
    }
    .section-card h2 .icon-badge svg { width: 16px; height: 16px; stroke: var(--accent-light); fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
    .section-card .subtitle { font-size: 13px; color: var(--text-dim); margin-bottom: 24px; }

    /* ─── Form fields ─── */
    .field { margin-bottom: 20px; }
    .field-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .field label {
      display: block; font-size: 12px; font-weight: 500;
      color: var(--text); margin-bottom: 7px;
      font-family: var(--font-mono); letter-spacing: 0.3px;
    }
    .field label .req { color: var(--rose); margin-left: 2px; }
    .field label .hint {
      font-weight: 300; color: var(--text-dim); font-size: 11px;
      display: block; margin-top: 2px; font-family: var(--font-body);
    }
    .field input, .field select, .field textarea {
      width: 100%; padding: 12px 14px;
      background: var(--bg-input); border: 1px solid var(--border);
      border-radius: var(--radius-sm); color: var(--text-bright);
      font-family: var(--font-mono); font-size: 13px;
      transition: all var(--transition); outline: none;
    }
    .field input::placeholder, .field textarea::placeholder { color: var(--text-muted); }
    .field input:focus, .field select:focus, .field textarea:focus {
      border-color: var(--border-focus);
      box-shadow: 0 0 0 3px var(--accent-glow);
    }
    .field select { cursor: pointer; appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%235a6275' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 14px center; padding-right: 36px; }
    .field textarea { resize: vertical; min-height: 80px; font-family: var(--font-body); line-height: 1.5; }

    /* Toggle switch */
    .toggle-row {
      display: flex; align-items: center; justify-content: space-between;
      padding: 16px 18px; border-radius: var(--radius);
      background: var(--bg-input); border: 1px solid var(--border);
      cursor: pointer; transition: all var(--transition);
    }
    .toggle-row:hover { border-color: rgba(255,255,255,0.06); }
    .toggle-label { font-size: 13px; color: var(--text); }
    .toggle-label small { display: block; font-size: 11px; color: var(--text-dim); margin-top: 2px; }
    .toggle-track {
      width: 44px; height: 24px; border-radius: 12px;
      background: var(--border); position: relative;
      transition: background var(--transition); flex-shrink: 0;
    }
    .toggle-track::after {
      content: '';
      position: absolute; top: 3px; left: 3px;
      width: 18px; height: 18px; border-radius: 50%;
      background: #fff; transition: transform var(--transition);
    }
    .toggle-row.on .toggle-track { background: var(--mint); }
    .toggle-row.on .toggle-track::after { transform: translateX(20px); }

    /* ─── Price configurator ─── */
    .price-config {
      display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: end;
    }
    .price-config .currency-tag {
      padding: 12px 18px; background: var(--bg-input);
      border: 1px solid var(--border); border-radius: var(--radius-sm);
      font-family: var(--font-mono); font-size: 13px; color: var(--accent-light);
      font-weight: 500; white-space: nowrap; height: 44px;
      display: flex; align-items: center;
    }

    /* ─── Preview card ─── */
    .preview-frame {
      background: var(--bg); border: 1px solid var(--border);
      border-radius: var(--radius-lg); overflow: hidden;
      box-shadow: var(--shadow-glow);
    }
    .preview-bar {
      display: flex; align-items: center; gap: 6px;
      padding: 10px 16px; background: var(--bg-elevated);
      border-bottom: 1px solid var(--border);
    }
    .preview-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--border); }
    .preview-url {
      flex: 1; text-align: center; font-family: var(--font-mono);
      font-size: 11px; color: var(--text-muted);
    }
    .preview-body { padding: 24px; }

    /* Mini video preview */
    .mini-video-area {
      width: 100%; aspect-ratio: 16/9;
      background: #0a0a0a; border-radius: var(--radius);
      overflow: hidden; position: relative;
      margin-bottom: 16px;
    }
    .mini-lock {
      position: absolute; inset: 0;
      background: linear-gradient(180deg, rgba(5,6,8,0.5) 0%, rgba(5,6,8,0.92) 100%);
      display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px;
      backdrop-filter: blur(4px);
    }
    .mini-lock-icon {
      width: 44px; height: 44px; border-radius: 50%;
      background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08);
      display: grid; place-items: center;
    }
    .mini-lock-icon svg { width: 20px; height: 20px; stroke: var(--accent-light); fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
    .mini-lock-text { font-size: 12px; color: var(--text-dim); text-align: center; }
    .mini-lock-text strong { color: var(--text-bright); font-weight: 600; }
    .mini-title { font-size: 15px; font-weight: 600; color: var(--text-bright); margin-bottom: 4px; }
    .mini-desc { font-size: 12px; color: var(--text-dim); margin-bottom: 14px; line-height: 1.5; }
    .mini-price-row {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 14px; border-radius: var(--radius-sm);
      background: rgba(45,106,223,0.04); border: 1px solid rgba(45,106,223,0.1);
      margin-bottom: 12px;
    }
    .mini-price-label { font-family: var(--font-mono); font-size: 10px; text-transform: uppercase; letter-spacing: 1px; color: var(--text-dim); }
    .mini-price-value { font-family: var(--font-mono); font-size: 16px; font-weight: 500; color: var(--text-bright); }
    .mini-price-value .cur { font-size: 11px; color: var(--accent-light); margin-left: 3px; }
    .mini-chips { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 14px; }
    .mini-chip {
      font-family: var(--font-mono); font-size: 10px; padding: 4px 8px;
      border-radius: 5px; background: rgba(255,255,255,0.02);
      border: 1px solid var(--border); color: var(--text-dim);
    }
    .mini-chip strong { color: var(--text); }
    .mini-chip.lifetime { border-color: rgba(52,211,153,0.2); background: var(--mint-dim); }
    .mini-chip.lifetime strong { color: var(--mint); }
    .mini-btn {
      width: 100%; padding: 12px; border: none; border-radius: var(--radius-sm);
      background: linear-gradient(135deg, var(--accent), #4a5af5);
      color: #fff; font-family: var(--font-body); font-size: 13px; font-weight: 600;
      cursor: default;
    }

    /* ─── Action buttons ─── */
    .actions { display: flex; gap: 12px; margin-top: 32px; }
    .btn {
      padding: 12px 24px; border-radius: var(--radius);
      font-family: var(--font-body); font-size: 13px; font-weight: 600;
      cursor: pointer; transition: all var(--transition);
      display: flex; align-items: center; gap: 8px; border: none;
    }
    .btn svg { width: 16px; height: 16px; stroke: currentColor; fill: none; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
    .btn-primary {
      background: linear-gradient(135deg, var(--accent), #4a5af5);
      color: #fff; box-shadow: 0 4px 20px var(--accent-glow);
    }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 6px 28px rgba(45,106,223,0.25); }
    .btn-secondary {
      background: var(--bg-input); color: var(--text);
      border: 1px solid var(--border);
    }
    .btn-secondary:hover { border-color: rgba(255,255,255,0.1); color: var(--text-bright); }
    .btn-success {
      background: var(--mint); color: #000;
    }
    .btn-success:hover { filter: brightness(1.1); }
    .btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none !important; }

    /* ─── Deploy output ─── */
    .deploy-output {
      margin-top: 24px; display: none;
    }
    .deploy-output.show { display: block; animation: sectionIn 0.35s ease; }
    .output-block {
      background: var(--bg-input); border: 1px solid var(--border);
      border-radius: var(--radius); overflow: hidden; margin-bottom: 16px;
    }
    .output-block-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 16px; background: rgba(255,255,255,0.01);
      border-bottom: 1px solid var(--border);
      font-family: var(--font-mono); font-size: 11px; color: var(--text-dim);
    }
    .copy-btn {
      background: none; border: 1px solid var(--border); border-radius: 5px;
      padding: 4px 10px; font-family: var(--font-mono); font-size: 10px;
      color: var(--text-dim); cursor: pointer; transition: all var(--transition);
    }
    .copy-btn:hover { border-color: var(--accent); color: var(--accent-light); }
    .output-block pre {
      padding: 16px; font-family: var(--font-mono); font-size: 12px;
      color: var(--text); line-height: 1.7; overflow-x: auto;
      white-space: pre-wrap; word-break: break-all;
    }
    .output-block pre .key { color: var(--accent-light); }
    .output-block pre .val { color: var(--mint); }
    .output-block pre .comment { color: var(--text-muted); }

    /* ─── Status toast ─── */
    .toast {
      position: fixed; bottom: 24px; right: 24px; z-index: 100;
      padding: 14px 20px; border-radius: var(--radius);
      font-size: 13px; font-family: var(--font-mono);
      display: none; animation: toastIn 0.3s ease;
      max-width: 420px;
    }
    .toast.show { display: flex; align-items: center; gap: 10px; }
    .toast.success { background: rgba(52,211,153,0.12); border: 1px solid rgba(52,211,153,0.2); color: var(--mint); }
    .toast.error { background: var(--rose-dim); border: 1px solid rgba(244,63,94,0.2); color: var(--rose); }
    .toast.info { background: var(--accent-glow); border: 1px solid rgba(45,106,223,0.2); color: var(--accent-light); }
    @keyframes toastIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* ─── Responsive ─── */
    @media (max-width: 860px) {
      .shell { grid-template-columns: 1fr; }
      .sidebar {
        position: relative; height: auto;
        flex-direction: row; flex-wrap: wrap;
        padding: 16px; gap: 12px;
        align-items: center;
      }
      .sidebar-brand { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }
      .nav-section, .sidebar-footer { display: none; }
      .main { padding: 24px 20px 60px; }
      .field-row { grid-template-columns: 1fr; }
      .wizard-steps { flex-wrap: wrap; }
    }
  </style>
</head>
<body>
  <div class="atmosphere"></div>
  <div class="noise-overlay"></div>

  <div class="shell">
    <!-- ─── Sidebar ─── -->
    <aside class="sidebar">
      <div class="sidebar-brand">
        <div class="brand-mark">A</div>
        <div class="brand-label">
          Creator Studio
          <small>A402 Protocol · Apertum</small>
        </div>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Workspace</div>
        <div class="nav-item active" onclick="goToStep(0)">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          New Content
        </div>
        <div class="nav-item" style="opacity:0.4; cursor:default;">
          <svg viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
          My Content
          <span class="nav-badge">soon</span>
        </div>
        <div class="nav-item" style="opacity:0.4; cursor:default;">
          <svg viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
          Revenue
          <span class="nav-badge">soon</span>
        </div>
      </div>

      <div class="nav-section">
        <div class="nav-section-title">Settings</div>
        <div class="nav-item" style="opacity:0.4; cursor:default;">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
          Wallet & Chain
        </div>
      </div>

      <div class="sidebar-footer">
        <div class="chain-status">
          <div class="chain-dot"></div>
          eip155:2786 · Apertum Mainnet
        </div>
      </div>
    </aside>

    <!-- ─── Main content ─── -->
    <main class="main">
      <div class="page-header">
        <h1>Create Paid Content</h1>
        <p>Set up a pay-to-watch video using the A402Verifier contract. Your viewers pay via the Apertum blockchain — funds go directly to your wallet.</p>
      </div>

      <!-- Wizard steps -->
      <div class="wizard-steps">
        <div class="wiz-step active" id="wizStep0" onclick="goToStep(0)">
          <span class="num">1</span> Content
        </div>
        <div class="wiz-step-divider"></div>
        <div class="wiz-step" id="wizStep1" onclick="goToStep(1)">
          <span class="num">2</span> Pricing
        </div>
        <div class="wiz-step-divider"></div>
        <div class="wiz-step" id="wizStep2" onclick="goToStep(2)">
          <span class="num">3</span> Preview & Deploy
        </div>
      </div>

      <!-- ══════════ Step 1: Content ══════════ -->
      <div class="form-section active" id="section0">
        <div class="section-card">
          <h2>
            <span class="icon-badge"><svg viewBox="0 0 24 24"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2"/></svg></span>
            Video Details
          </h2>
          <p class="subtitle">Enter the YouTube video you want to gate behind a payment wall.</p>

          <div class="field">
            <label>Video Title <span class="req">*</span></label>
            <input type="text" id="videoTitle" placeholder="e.g., Advanced Solidity Patterns — Apertum Edition" oninput="updatePreview()">
          </div>

          <div class="field">
            <label>
              YouTube Video ID <span class="req">*</span>
              <span class="hint">The part after "v=" in a YouTube URL (e.g., dQw4w9WgXcQ)</span>
            </label>
            <input type="text" id="youtubeId" placeholder="dQw4w9WgXcQ" oninput="updatePreview()">
          </div>

          <div class="field">
            <label>Description</label>
            <textarea id="videoDesc" placeholder="What will viewers get? Describe the content..." oninput="updatePreview()"></textarea>
          </div>

          <div class="field">
            <label>
              Resource ID <span class="req">*</span>
              <span class="hint">Unique on-chain identifier for this content (e.g., video-001, course-intro)</span>
            </label>
            <input type="text" id="resourceId" placeholder="video-001" value="video-001" oninput="updatePreview()">
          </div>
        </div>

        <div class="actions">
          <button class="btn btn-primary" onclick="goToStep(1)">
            Continue to Pricing
            <svg viewBox="0 0 24 24"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
          </button>
        </div>
      </div>

      <!-- ══════════ Step 2: Pricing ══════════ -->
      <div class="form-section" id="section1">
        <div class="section-card">
          <h2>
            <span class="icon-badge"><svg viewBox="0 0 24 24"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></span>
            Payment Configuration
          </h2>
          <p class="subtitle">Set the price and access model. Payments go directly to your wallet through the A402Verifier contract.</p>

          <div class="field">
            <label>Price <span class="req">*</span></label>
            <div class="price-config">
              <input type="number" id="price" value="0.001" min="0.0001" step="0.0001" oninput="updatePreview()">
              <div class="currency-tag">APTM</div>
            </div>
          </div>

          <div class="field">
            <label>Your Wallet Address <span class="req">*</span>
              <span class="hint">Creator address that receives payments</span>
            </label>
            <input type="text" id="walletAddress" placeholder="0x..." oninput="updatePreview()">
          </div>

          <div class="field" style="margin-top: 20px;">
            <div class="toggle-row on" id="lifetimeToggle" onclick="toggleLifetime()">
              <div class="toggle-label">
                Lifetime Access
                <small>Users pay once and get permanent on-chain access — no repeat payments needed</small>
              </div>
              <div class="toggle-track"></div>
            </div>
          </div>
        </div>

        <div class="section-card">
          <h2>
            <span class="icon-badge" style="background: var(--violet-dim); border-color: rgba(139,92,246,0.12);"><svg viewBox="0 0 24 24" style="stroke: var(--violet);"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg></span>
            Contract Settings
          </h2>
          <p class="subtitle">Advanced — the A402Verifier contract handles payment verification, replay protection, and fund forwarding.</p>

          <div class="field">
            <label>
              Verifier Contract Address
              <span class="hint">Pre-deployed A402Verifier on Apertum. Change only if deploying your own.</span>
            </label>
            <input type="text" id="contractAddress" value="0xB72DEf207FB8CC18afA130064475B37100B906AE" oninput="updatePreview()">
          </div>

          <div class="field-row">
            <div class="field">
              <label>Chain ID</label>
              <input type="text" value="2786" disabled style="opacity: 0.5;">
            </div>
            <div class="field">
              <label>Network</label>
              <input type="text" value="Apertum (eip155:2786)" disabled style="opacity: 0.5;">
            </div>
          </div>
        </div>

        <div class="actions">
          <button class="btn btn-secondary" onclick="goToStep(0)">
            <svg viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
            Back
          </button>
          <button class="btn btn-primary" onclick="goToStep(2)">
            Preview & Deploy
            <svg viewBox="0 0 24 24"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
          </button>
        </div>
      </div>

      <!-- ══════════ Step 3: Preview & Deploy ══════════ -->
      <div class="form-section" id="section2">
        <div class="section-card">
          <h2>
            <span class="icon-badge" style="background: var(--mint-dim); border-color: rgba(52,211,153,0.12);"><svg viewBox="0 0 24 24" style="stroke: var(--mint);"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></span>
            Live Preview
          </h2>
          <p class="subtitle">This is what your viewers will see before paying.</p>

          <div class="preview-frame">
            <div class="preview-bar">
              <div class="preview-dot"></div>
              <div class="preview-dot"></div>
              <div class="preview-dot"></div>
              <div class="preview-url" id="previewUrl">localhost:3000</div>
            </div>
            <div class="preview-body">
              <div class="mini-video-area">
                <div class="mini-lock">
                  <div class="mini-lock-icon">
                    <svg viewBox="0 0 24 24"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                  </div>
                  <div class="mini-lock-text"><strong>Locked</strong><br>Pay via A402 to unlock</div>
                </div>
              </div>
              <div class="mini-title" id="prevTitle">Your Video Title</div>
              <div class="mini-desc" id="prevDesc">Video description will appear here...</div>
              <div class="mini-price-row">
                <span class="mini-price-label">Content</span>
                <span class="mini-price-value" id="prevPrice">0.001<span class="cur">APTM</span></span>
              </div>
              <div class="mini-chips">
                <div class="mini-chip"><strong>Protocol</strong> HTTP 402</div>
                <div class="mini-chip"><strong>Verified</strong> On-Chain</div>
                <div class="mini-chip"><strong>Finality</strong> ~1s</div>
                <div class="mini-chip lifetime" id="prevLifetimeChip"><strong>♾ Lifetime</strong></div>
              </div>
              <div class="mini-btn">Connect Wallet</div>
            </div>
          </div>
        </div>

        <div class="section-card">
          <h2>
            <span class="icon-badge" style="background: var(--amber-dim); border-color: rgba(245,158,11,0.12);"><svg viewBox="0 0 24 24" style="stroke: var(--amber);"><path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/></svg></span>
            Generate Configuration
          </h2>
          <p class="subtitle">Generate your <code>.env</code> file and server config. Copy these into your prototype to go live.</p>

          <div class="actions" style="margin-top: 0;">
            <button class="btn btn-success" onclick="generateConfig()" id="deployBtn">
              <svg viewBox="0 0 24 24"><polyline points="16 18 22 12 16 6"/><polyline points="8 6 2 12 8 18"/></svg>
              Generate .env + Config
            </button>
            <button class="btn btn-secondary" onclick="connectAndConfigure()" id="connectBtn">
              <svg viewBox="0 0 24 24"><path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4"/><path d="M4 6v12c0 1.1.9 2 2 2h14v-4"/><circle cx="18" cy="16" r="2"/></svg>
              Connect Wallet to Auto-Fill
            </button>
          </div>
        </div>

        <div class="deploy-output" id="deployOutput">
          <div class="output-block">
            <div class="output-block-header">
              <span>.env</span>
              <button class="copy-btn" onclick="copyEnv()">Copy</button>
            </div>
            <pre id="envOutput"></pre>
          </div>

          <div class="output-block">
            <div class="output-block-header">
              <span>Quick Start Commands</span>
              <button class="copy-btn" onclick="copyCommands()">Copy</button>
            </div>
            <pre id="cmdOutput"></pre>
          </div>

          <div class="output-block">
            <div class="output-block-header">
              <span>Contract Interaction (configureResource)</span>
              <button class="copy-btn" onclick="copyContractCall()">Copy</button>
            </div>
            <pre id="contractOutput"></pre>
          </div>
        </div>

        <div class="actions">
          <button class="btn btn-secondary" onclick="goToStep(1)">
            <svg viewBox="0 0 24 24"><line x1="19" y1="12" x2="5" y2="12"/><polyline points="12 19 5 12 12 5"/></svg>
            Back
          </button>
        </div>
      </div>

    </main>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

<script>
// ═══════════════════════════════════════════════════════════════
//  WIZARD STATE
// ═══════════════════════════════════════════════════════════════

let currentStep = 0;
let lifetimeAccess = true;

function goToStep(step) {
  // Validate before advancing
  if (step > currentStep) {
    if (currentStep === 0 && !validateStep0()) return;
    if (currentStep === 1 && !validateStep1()) return;
  }

  currentStep = step;

  // Update sections
  document.querySelectorAll('.form-section').forEach((s, i) => {
    s.classList.toggle('active', i === step);
  });

  // Update wizard step indicators
  document.querySelectorAll('.wiz-step').forEach((s, i) => {
    s.classList.remove('active', 'completed');
    if (i === step) s.classList.add('active');
    else if (i < step) s.classList.add('completed');
  });

  updatePreview();
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function validateStep0() {
  const title = document.getElementById('videoTitle').value.trim();
  const ytId = document.getElementById('youtubeId').value.trim();
  const resId = document.getElementById('resourceId').value.trim();

  if (!title) { showToast('error', 'Please enter a video title'); document.getElementById('videoTitle').focus(); return false; }
  if (!ytId) { showToast('error', 'Please enter a YouTube video ID'); document.getElementById('youtubeId').focus(); return false; }
  if (!resId) { showToast('error', 'Please enter a resource ID'); document.getElementById('resourceId').focus(); return false; }
  return true;
}

function validateStep1() {
  const price = parseFloat(document.getElementById('price').value);
  const wallet = document.getElementById('walletAddress').value.trim();

  if (!price || price <= 0) { showToast('error', 'Please set a valid price'); document.getElementById('price').focus(); return false; }
  if (!wallet || !wallet.startsWith('0x') || wallet.length !== 42) {
    showToast('error', 'Please enter a valid Ethereum wallet address (0x...)');
    document.getElementById('walletAddress').focus();
    return false;
  }
  return true;
}

function toggleLifetime() {
  lifetimeAccess = !lifetimeAccess;
  document.getElementById('lifetimeToggle').classList.toggle('on', lifetimeAccess);
  updatePreview();
}

// ═══════════════════════════════════════════════════════════════
//  LIVE PREVIEW
// ═══════════════════════════════════════════════════════════════

function updatePreview() {
  const title = document.getElementById('videoTitle').value || 'Your Video Title';
  const desc = document.getElementById('videoDesc').value || 'Video description will appear here...';
  const price = document.getElementById('price').value || '0.001';

  document.getElementById('prevTitle').textContent = title;
  document.getElementById('prevDesc').textContent = desc;
  document.getElementById('prevPrice').innerHTML = `${price}<span class="cur">APTM</span>`;
  document.getElementById('prevLifetimeChip').style.display = lifetimeAccess ? 'inline-block' : 'none';
}

// ═══════════════════════════════════════════════════════════════
//  WALLET CONNECT (auto-fill creator address)
// ═══════════════════════════════════════════════════════════════

async function connectAndConfigure() {
  if (!window.ethereum) {
    showToast('error', 'No wallet detected. Install MetaMask.');
    return;
  }
  try {
    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
    const addr = accounts[0];
    document.getElementById('walletAddress').value = addr;
    updatePreview();

    // Try switching to Apertum
    const apertumHex = '0x' + (2786).toString(16);
    try {
      await window.ethereum.request({ method: 'wallet_switchEthereumChain', params: [{ chainId: apertumHex }] });
    } catch (switchErr) {
      if (switchErr.code === 4902) {
        await window.ethereum.request({
          method: 'wallet_addEthereumChain',
          params: [{
            chainId: apertumHex,
            chainName: 'Apertum',
            nativeCurrency: { name: 'APTM', symbol: 'APTM', decimals: 18 },
            rpcUrls: ['https://rpc.apertum.io/ext/bc/YDJ1r9RMkewATmA7B35q1bdV18aywzmdiXwd9zGBq3uQjsCnn/rpc'],
            blockExplorerUrls: ['https://explorer.apertum.io'],
          }],
        });
      }
    }
    showToast('success', `Wallet connected: ${addr.slice(0,6)}...${addr.slice(-4)}`);
  } catch (err) {
    showToast('error', 'Wallet connection failed: ' + (err.message || err));
  }
}

// ═══════════════════════════════════════════════════════════════
//  GENERATE CONFIG
// ═══════════════════════════════════════════════════════════════

function generateConfig() {
  if (!validateStep0() || !validateStep1()) return;

  const title = document.getElementById('videoTitle').value.trim();
  const ytId = document.getElementById('youtubeId').value.trim();
  const resId = document.getElementById('resourceId').value.trim();
  const price = document.getElementById('price').value;
  const wallet = document.getElementById('walletAddress').value.trim();
  const contract = document.getElementById('contractAddress').value.trim();

  // .env file
  const envContent = `<span class="comment"># Apertum A402 — Generated by Creator Studio</span>
<span class="comment"># ${new Date().toISOString()}</span>

<span class="comment"># Apertum RPC endpoint</span>
<span class="key">APERTUM_RPC</span>=<span class="val">https://rpc.apertum.io/ext/bc/YDJ1r9RMkewATmA7B35q1bdV18aywzmdiXwd9zGBq3uQjsCnn/rpc</span>

<span class="comment"># Creator wallet (receives payments)</span>
<span class="key">PAYMENT_ADDRESS</span>=<span class="val">${wallet}</span>

<span class="comment"># Content: ${title}</span>
<span class="key">YOUTUBE_VIDEO_ID</span>=<span class="val">${ytId}</span>
<span class="key">RESOURCE_ID</span>=<span class="val">${resId}</span>
<span class="key">PRICE</span>=<span class="val">${price}</span>

<span class="comment"># Access model</span>
<span class="key">LIFETIME_ACCESS</span>=<span class="val">${lifetimeAccess}</span>

<span class="comment"># A402Verifier contract</span>
<span class="key">VERIFIER_CONTRACT</span>=<span class="val">${contract}</span>

<span class="key">PORT</span>=<span class="val">3000</span>`;

  document.getElementById('envOutput').innerHTML = envContent;

  // Commands
  const cmdContent = `<span class="comment"># Clone the prototype and start</span>
<span class="val">git clone https://github.com/your-repo/apertum-x402-prototype.git</span>
<span class="val">cd apertum-x402-prototype</span>
<span class="val">npm install</span>

<span class="comment"># Copy your generated .env into the project root, then:</span>
<span class="val">npm start</span>

<span class="comment"># Open http://localhost:3000 with MetaMask</span>
<span class="comment"># Your viewers will see the payment gate → pay → unlock video</span>`;

  document.getElementById('cmdOutput').innerHTML = cmdContent;

  // Contract call (if lifetime access, they need to call configureResource)
  const priceWei = toWeiStr(price);
  const contractContent = lifetimeAccess
    ? `<span class="comment">// Call this on the A402Verifier contract to enable lifetime access</span>
<span class="comment">// Use Remix, Hardhat, or cast (Foundry) to call:</span>

<span class="key">Function:</span> <span class="val">configureResource(string, bool, uint256)</span>

<span class="key">resourceId:</span>  <span class="val">"${resId}"</span>
<span class="key">lifetimeAccess:</span> <span class="val">true</span>
<span class="key">price:</span>       <span class="val">${priceWei}</span> <span class="comment">// ${price} APTM in wei</span>

<span class="comment">// Example using cast (Foundry):</span>
<span class="val">cast send ${contract} \\
  "configureResource(string,bool,uint256)" \\
  "${resId}" true ${priceWei} \\
  --rpc-url https://rpc.apertum.io/ext/bc/YDJ1r9RMkewATmA7B35q1bdV18aywzmdiXwd9zGBq3uQjsCnn/rpc \\
  --private-key YOUR_PRIVATE_KEY</span>

<span class="comment">// This registers "${resId}" as lifetime-access on the contract.</span>
<span class="comment">// After this, the server's hasAccess() check will work for returning users.</span>`
    : `<span class="comment">// Pay-per-access mode — no configureResource call needed.</span>
<span class="comment">// Each payment is verified by event logs only.</span>
<span class="comment">// The server checks the AccessPaid event on every request.</span>`;

  document.getElementById('contractOutput').innerHTML = contractContent;

  // Show output
  document.getElementById('deployOutput').classList.add('show');
  showToast('success', 'Configuration generated! Copy your .env and start the server.');
}

function toWeiStr(aptm) {
  const parts = aptm.toString().split('.');
  const whole = parts[0] || '0';
  const frac = (parts[1] || '').padEnd(18, '0').slice(0, 18);
  return (BigInt(whole + frac)).toString();
}

// ═══════════════════════════════════════════════════════════════
//  COPY HELPERS
// ═══════════════════════════════════════════════════════════════

function copyEnv() { copyBlock('envOutput', '.env copied to clipboard!'); }
function copyCommands() { copyBlock('cmdOutput', 'Commands copied!'); }
function copyContractCall() { copyBlock('contractOutput', 'Contract call copied!'); }

function copyBlock(id, msg) {
  const el = document.getElementById(id);
  const text = el.innerText;
  navigator.clipboard.writeText(text).then(() => showToast('success', msg));
}

// ═══════════════════════════════════════════════════════════════
//  TOAST
// ═══════════════════════════════════════════════════════════════

let toastTimer;
function showToast(type, msg) {
  const toast = document.getElementById('toast');
  clearTimeout(toastTimer);
  toast.className = `toast show ${type}`;
  toast.textContent = msg;
  toastTimer = setTimeout(() => { toast.classList.remove('show'); }, 3500);
}
</script>
</body>
</html>
